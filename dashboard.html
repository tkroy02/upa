<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scheduler Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="dashboard.css">
    <style>
        /* Additional styles for improved features */
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--white, #fff);
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
            padding: 1rem 1.5rem;
            z-index: 3000;
            transform: translateX(400px);
            transition: all 0.3s ease;
            max-width: 350px;
        }
        .toast.show { transform: translateX(0); }
        .toast-success { border-left: 4px solid #48bb78; }
        .toast-error { border-left: 4px solid #e63946; }
        .toast-warning { border-left: 4px solid #f77f00; }
        
        .loading {
            width: 16px;
            height: 16px;
            border: 2px solid transparent;
            border-top: 2px solid currentColor;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .fade-out {
            opacity: 0.5;
            text-decoration: line-through;
            pointer-events: none;
        }
        
        @keyframes slideIn {
            from { transform: translateY(-50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .modal-content {
            animation: slideIn 0.3s ease;
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2><i class="fas fa-calendar-alt"></i> <span>Scheduler</span></h2>
            </div>
            <ul class="sidebar-menu">
                <li class="menu-item active" data-tab="dashboard">
                    <i class="fas fa-home"></i> <span>Dashboard</span>
                </li>
                <li class="menu-item" data-tab="sessions">
                    <i class="fas fa-clock"></i> <span>Sessions</span>
                </li>
                <li class="menu-item" data-tab="availability">
                    <i class="fas fa-calendar-plus"></i> <span>Availability</span>
                </li>
                <li class="menu-item" data-tab="tutors">
                    <i class="fas fa-chalkboard-teacher"></i> <span>Tutors</span>
                </li>
                <li class="menu-item" data-tab="calendar">
                    <i class="fas fa-calendar"></i> <span>Calendar</span>
                </li>
                <li class="menu-item" data-tab="settings">
                    <i class="fas fa-cog"></i> <span>Settings</span>
                </li>
            </ul>
        </div>

        <div class="main-content">
            <div class="header">
                <div class="welcome-msg">
                    Welcome back, <span id="userName">User</span>!
                </div>
                <div class="user-actions">
                    <div class="notification-bell">
                        <i class="fas fa-bell"></i>
                        <span class="notification-badge">3</span>
                    </div>
                    <button class="logout-btn" id="logoutBtn">
                        <i class="fas fa-sign-out-alt"></i> Logout
                    </button>
                </div>
            </div>

            <div id="dashboardContent">
                <div class="dashboard-cards">
                    <div class="card stat-card">
                        <div class="stat-icon" style="background: rgba(67, 97, 238, 0.15); color: var(--primary);">
                            <i class="fas fa-clock"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="upcomingSessionsCount">0</div>
                            <div class="stat-title">Upcoming Sessions</div>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="stat-icon" style="background: rgba(76, 201, 240, 0.15); color: var(--success);">
                            <i class="fas fa-calendar-check"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="completedSessionsCount">0</div>
                            <div class="stat-title">Completed Sessions</div>
                        </div>
                    </div>
                    <div class="card stat-card">
                        <div class="stat-icon" style="background: rgba(247, 37, 133, 0.15); color: var(--warning);">
                            <i class="fas fa-chalkboard-teacher"></i>
                        </div>
                        <div class="stat-content">
                            <div class="stat-value" id="availableTutorsCount">0</div>
                            <div class="stat-title">Available Tutors</div>
                        </div>
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-header">
                        <h3 class="section-title">Upcoming Sessions</h3>
                        <div class="section-actions">
                            <button class="btn btn-outline">
                                <i class="fas fa-calendar"></i> View All
                            </button>
                        </div>
                    </div>
                    <div class="sessions-container" id="upcomingSessions">
                        <!-- Sessions populated by JavaScript -->
                    </div>
                </div>

                <div class="content-section">
                    <div class="section-header">
                        <h3 class="section-title">Recent Activity</h3>
                    </div>
                    <div class="activity-list" id="recentActivity">
                        <!-- Activity populated by JavaScript -->
                    </div>
                </div>
            </div>

            <div id="roleSpecificContent" class="hidden">
                <!-- Content populated by JavaScript based on user role -->
            </div>
        </div>
    </div>

    <!-- Create Slot Modal -->
    <div id="createSlotModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="modal-header">
                <h3 class="modal-title">Create Availability Slot</h3>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Date</label>
                    <input type="date" id="slotDate" class="form-control">
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label class="form-label">Start Time</label>
                        <input type="time" id="startTime" class="form-control">
                    </div>
                    <div class="form-group">
                        <label class="form-label">End Time</label>
                        <input type="time" id="endTime" class="form-control">
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelSlotBtn">Cancel</button>
                <button class="btn btn-primary" id="confirmCreateSlotBtn">Create Slot</button>
            </div>
        </div>
    </div>

    <!-- Confirmation Modal -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <span class="close-btn">&times;</span>
            <div class="modal-header">
                <h3 class="modal-title">Confirm Action</h3>
            </div>
            <div class="modal-body">
                <p id="confirmationMessage">Are you sure you want to proceed?</p>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelActionBtn">Cancel</button>
                <button class="btn btn-primary" id="confirmActionBtn">Confirm</button>
            </div>
        </div>
    </div>

    <div class="menu-toggle" id="menuToggle">
        <i class="fas fa-bars"></i>
    </div>

    <script type="module">
        // Enhanced Application Architecture
        class SchedulerApp {
            constructor() {
                this.currentUser = null;
                this.eventListeners = new Map();
                this.components = new Map();
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.authenticateUser();
            }

            setupEventListeners() {
                document.getElementById('menuToggle').addEventListener('click', () => {
                    document.getElementById('sidebar').classList.toggle('mobile-open');
                });

                this.setupModalEvents();
                this.setupNavigation();
            }

            setupModalEvents() {
                document.querySelectorAll('.close-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const modal = e.target.closest('.modal');
                        if (modal) this.hideModal(modal.id);
                    });
                });

                window.addEventListener('click', (event) => {
                    if (event.target.classList.contains('modal')) {
                        this.hideModal(event.target.id);
                    }
                });

                document.getElementById('cancelSlotBtn').addEventListener('click', () => {
                    this.hideModal('createSlotModal');
                });

                document.getElementById('cancelActionBtn').addEventListener('click', () => {
                    this.hideModal('confirmationModal');
                });
            }

            setupNavigation() {
                document.querySelectorAll('.menu-item').forEach(item => {
                    item.addEventListener('click', () => {
                        this.handleNavigation(item);
                    });
                });

                document.getElementById('logoutBtn').addEventListener('click', () => {
                    this.handleLogout();
                });
            }

            handleNavigation(item) {
                document.querySelectorAll('.menu-item').forEach(i => i.classList.remove('active'));
                item.classList.add('active');

                const tabName = item.dataset.tab;
                
                if (tabName === 'dashboard') {
                    this.showDashboard();
                } else {
                    this.showToast(`${tabName.charAt(0).toUpperCase() + tabName.slice(1)} feature coming soon!`, 'warning');
                }
            }

            async authenticateUser() {
                try {
                    // Simulate authentication
                    setTimeout(() => {
                        this.currentUser = {
                            uid: 'demo-user-123',
                            name: 'Demo User',
                            role: 'student', // Change to 'tutor' to see tutor dashboard
                            approved: true
                        };
                        
                        if (this.currentUser.role === 'tutor' && !this.currentUser.approved) {
                            this.showConfirmation('Your tutor account is not approved yet. Contact admin.', () => {
                                this.handleLogout();
                            });
                            return;
                        }

                        this.renderUserInterface();
                    }, 100);
                } catch (error) {
                    this.handleError('Authentication failed', error);
                }
            }

            renderUserInterface() {
                document.getElementById('userName').textContent = this.currentUser.name;
                
                if (this.currentUser.role === 'tutor') {
                    this.renderTutorDashboard();
                } else {
                    this.renderStudentDashboard();
                }
            }

            renderTutorDashboard() {
                const tutorDashboard = new TutorDashboard(this);
                this.components.set('tutorDashboard', tutorDashboard);
                tutorDashboard.render();
            }

            renderStudentDashboard() {
                const studentDashboard = new StudentDashboard(this);
                this.components.set('studentDashboard', studentDashboard);
                studentDashboard.render();
            }

            showDashboard() {
                if (this.currentUser) {
                    this.renderUserInterface();
                }
            }

            showModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'flex';
                    document.body.style.overflow = 'hidden';
                }
            }

            hideModal(modalId) {
                const modal = document.getElementById(modalId);
                if (modal) {
                    modal.style.display = 'none';
                    document.body.style.overflow = 'auto';
                }
            }

            showConfirmation(message, onConfirm) {
                document.getElementById('confirmationMessage').textContent = message;
                this.showModal('confirmationModal');
                
                const confirmBtn = document.getElementById('confirmActionBtn');
                const newConfirmBtn = confirmBtn.cloneNode(true);
                confirmBtn.parentNode.replaceChild(newConfirmBtn, confirmBtn);
                
                if (onConfirm) {
                    newConfirmBtn.addEventListener('click', () => {
                        this.hideModal('confirmationModal');
                        onConfirm();
                    });
                }
            }

            showToast(message, type = 'success') {
                const toast = document.createElement('div');
                toast.className = `toast toast-${type}`;
                toast.innerHTML = `
                    <div style="display: flex; align-items: center; gap: 0.5rem;">
                        <i class="fas fa-${type === 'success' ? 'check-circle' : type === 'error' ? 'exclamation-circle' : 'exclamation-triangle'}"></i>
                        <span>${message}</span>
                    </div>
                `;
                
                document.body.appendChild(toast);
                setTimeout(() => toast.classList.add('show'), 100);
                
                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => document.body.removeChild(toast), 300);
                }, 5000);
            }

            handleError(message, error) {
                console.error(message, error);
                this.showToast(`${message}. Please try again.`, 'error');
            }

            async handleLogout() {
                this.showConfirmation('Are you sure you want to logout?', async () => {
                    try {
                        // Simulate logout
                        window.location.href = 'login.html';
                    } catch (error) {
                        this.handleError('Logout failed', error);
                    }
                });
            }
        }

        // Base Dashboard Component
        class BaseDashboard {
            constructor(app) {
                this.app = app;
            }

            createEmptyState(icon, message, buttonText = null, buttonAction = null) {
                const emptyState = document.createElement('div');
                emptyState.className = 'empty-state';
                
                let buttonHtml = '';
                if (buttonText && buttonAction) {
                    const buttonId = 'empty-state-btn-' + Date.now();
                    buttonHtml = `<button class="btn btn-primary" id="${buttonId}">
                        <i class="fas fa-plus"></i> ${buttonText}
                    </button>`;
                    
                    setTimeout(() => {
                        document.getElementById(buttonId)?.addEventListener('click', buttonAction);
                    }, 0);
                }
                
                emptyState.innerHTML = `
                    <i class="fas fa-${icon}"></i>
                    <p>${message}</p>
                    ${buttonHtml}
                `;
                
                return emptyState;
            }

            createLoadingState() {
                const loadingState = document.createElement('div');
                loadingState.className = 'empty-state';
                loadingState.innerHTML = `
                    <div class="loading" style="width: 40px; height: 40px; margin: 0 auto 1rem;"></div>
                    <p>Loading...</p>
                `;
                return loadingState;
            }
        }

        // Student Dashboard Component
        class StudentDashboard extends BaseDashboard {
            render() {
                document.getElementById('dashboardContent').classList.remove('hidden');
                document.getElementById('roleSpecificContent').classList.add('hidden');
                
                this.loadStats();
                this.loadUpcomingSessions();
                this.loadRecentActivity();
            }

            async loadStats() {
                setTimeout(() => {
                    document.getElementById('upcomingSessionsCount').textContent = '2';
                    document.getElementById('completedSessionsCount').textContent = '15';
                    document.getElementById('availableTutorsCount').textContent = '8';
                }, 500);
            }

            async loadUpcomingSessions() {
                const container = document.getElementById('upcomingSessions');
                container.innerHTML = '';
                container.appendChild(this.createLoadingState());
                
                setTimeout(() => {
                    container.innerHTML = '';
                    
                    const demoSessions = [
                        {
                            id: 'session-1',
                            date: '2025-09-20',
                            startTime: '14:00',
                            endTime: '15:00',
                            tutorName: 'Dr. Sarah Johnson',
                            subject: 'Mathematics',
                            status: 'upcoming'
                        }
                    ];

                    if (demoSessions.length === 0) {
                        container.appendChild(
                            this.createEmptyState(
                                'clock', 
                                "You don't have any upcoming sessions.",
                                'Book a Session',
                                () => this.app.showToast('Booking feature coming soon!', 'warning')
                            )
                        );
                        return;
                    }

                    demoSessions.forEach(session => {
                        const sessionCard = this.createSessionCard(session);
                        container.appendChild(sessionCard);
                    });
                }, 1000);
            }

            createSessionCard(session) {
                const sessionCard = document.createElement('div');
                sessionCard.className = 'session-card';
                sessionCard.innerHTML = `
                    <div class="session-header">
                        <div class="slot-date">${session.date}</div>
                        <span class="slot-status status-upcoming">${session.status}</span>
                    </div>
                    <div class="slot-time">${session.startTime} - ${session.endTime}</div>
                    <div class="tutor-info">
                        <p><strong>Tutor:</strong> ${session.tutorName}</p>
                        <p><strong>Subject:</strong> ${session.subject}</p>
                    </div>
                    <div class="session-actions">
                        <button class="btn btn-outline btn-sm cancel-session" data-sessionid="${session.id}">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                `;

                sessionCard.querySelector('.cancel-session').addEventListener('click', () => {
                    this.handleCancelSession(session.id, sessionCard);
                });

                return sessionCard;
            }

            handleCancelSession(sessionId, card) {
                this.app.showConfirmation('Cancel this session?', async () => {
                    const button = card.querySelector('.cancel-session');
                    const originalContent = button.innerHTML;
                    button.innerHTML = '<div class="loading"></div>';
                    button.disabled = true;

                    setTimeout(() => {
                        card.classList.add('fade-out');
                        this.app.showToast('Session cancelled successfully!', 'success');
                        setTimeout(() => this.loadUpcomingSessions(), 2000);
                    }, 1500);
                });
            }

            async loadRecentActivity() {
                const container = document.getElementById('recentActivity');
                container.innerHTML = '';
                container.appendChild(this.createLoadingState());

                setTimeout(() => {
                    container.innerHTML = '';
                    
                    const demoActivities = [
                        {
                            type: 'completed',
                            tutorName: 'Dr. Sarah Johnson',
                            date: '2025-09-15',
                            subject: 'Mathematics'
                        },
                        {
                            type: 'booked',
                            tutorName: 'Prof. Michael Chen', 
                            date: '2025-09-22',
                            subject: 'Physics'
                        }
                    ];

                    if (demoActivities.length === 0) {
                        container.appendChild(
                            this.createEmptyState('history', 'No recent activity found.')
                        );
                        return;
                    }

                    demoActivities.forEach(activity => {
                        const activityItem = document.createElement('div');
                        activityItem.className = 'activity-item';

                        let activityText = '';
                        let activityIcon = 'fas fa-calendar';

                        switch (activity.type) {
                            case 'completed':
                                activityText = `Completed session with ${activity.tutorName} on ${activity.date}`;
                                activityIcon = 'fas fa-check-circle text-success';
                                break;
                            case 'cancelled':
                                activityText = `Cancelled session with ${activity.tutorName} scheduled for ${activity.date}`;
                                activityIcon = 'fas fa-times-circle text-danger';
                                break;
                            default:
                                activityText = `Booked session with ${activity.tutorName} for ${activity.date}`;
                                activityIcon = 'fas fa-calendar-plus text-primary';
                        }

                        activityItem.innerHTML = `
                            <div style="display: flex; align-items: center; gap: 10px; padding: 10px 0; border-bottom: 1px solid var(--light-gray);">
                                <i class="${activityIcon}"></i>
                                <div>${activityText}</div>
                            </div>
                        `;

                        container.appendChild(activityItem);
                    });
                }, 800);
            }
        }

        // Tutor Dashboard Component
        class TutorDashboard extends BaseDashboard {
            render() {
                document.getElementById('dashboardContent').classList.add('hidden');
                document.getElementById('roleSpecificContent').classList.remove('hidden');
                
                this.renderTutorInterface();
                this.setupTutorEventListeners();
                this.loadTutorSlots();
                this.loadTutorSessions();
            }

            renderTutorInterface() {
                const container = document.getElementById('roleSpecificContent');
                container.innerHTML = `
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Tutor Dashboard</h3>
                            <div class="section-actions">
                                <button class="btn btn-primary" id="showCreateSlotModal">
                                    <i class="fas fa-plus"></i> Create Slot
                                </button>
                            </div>
                        </div>
                        <p>Manage your availability and view your upcoming sessions.</p>
                    </div>
                    
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Your Availability Slots</h3>
                        </div>
                        <div class="slots-container" id="tutorSlots">
                            <!-- Slots will be populated by JavaScript -->
                        </div>
                        <div class="text-center mt-20">
                            <button class="btn btn-outline" id="loadMoreTutorSlotsBtn">
                                <i class="fas fa-refresh"></i> Load More
                            </button>
                        </div>
                    </div>
                    
                    <div class="content-section">
                        <div class="section-header">
                            <h3 class="section-title">Upcoming Sessions</h3>
                        </div>
                        <div class="sessions-container" id="tutorSessions">
                            <!-- Sessions will be populated by JavaScript -->
                        </div>
                    </div>
                `;
            }

            setupTutorEventListeners() {
                document.getElementById('showCreateSlotModal').addEventListener('click', () => {
                    this.app.showModal('createSlotModal');
                });

                document.getElementById('confirmCreateSlotBtn').addEventListener('click', () => {
                    this.handleCreateSlot();
                });

                document.getElementById('loadMoreTutorSlotsBtn').addEventListener('click', () => {
                    this.loadTutorSlots(true);
                });
            }

            async handleCreateSlot() {
                const date = document.getElementById('slotDate').value;
                const startTime = document.getElementById('startTime').value;
                const endTime = document.getElementById('endTime').value;

                if (!date || !startTime || !endTime) {
                    this.app.showToast('Please fill all fields', 'warning');
                    return;
                }

                if (startTime >= endTime) {
                    this.app.showToast('End time must be after start time', 'warning');
                    return;
                }

                const button = document.getElementById('confirmCreateSlotBtn');
                const originalContent = button.innerHTML;
                button.innerHTML = '<div class="loading"></div>';
                button.disabled = true;

                setTimeout(() => {
                    this.app.hideModal('createSlotModal');
                    this.app.showToast('Availability slot created successfully!', 'success');
                    
                    // Clear form
                    document.getElementById('slotDate').value = '';
                    document.getElementById('startTime').value = '';
                    document.getElementById('endTime').value = '';
                    
                    // Reload slots
                    this.loadTutorSlots(false);
                    
                    button.innerHTML = originalContent;
                    button.disabled = false;
                }, 1500);
            }

            async loadTutorSlots(loadMore = false) {
                const container = document.getElementById('tutorSlots');
                const loadMoreBtn = document.getElementById('loadMoreTutorSlotsBtn');

                if (!loadMore) {
                    container.innerHTML = '';
                    container.appendChild(this.createLoadingState());
                }

                setTimeout(() => {
                    if (!loadMore) {
                        container.innerHTML = '';
                    }

                    const demoSlots = [
                        {
                            id: 'slot-1',
                            date: '2025-09-25',
                            startTime: '10:00',
                            endTime: '11:00'
                        },
                        {
                            id: 'slot-2',
                            date: '2025-09-26', 
                            startTime: '14:00',
                            endTime: '15:00'
                        }
                    ];

                    if (demoSlots.length === 0 && !loadMore) {
                        container.appendChild(
                            this.createEmptyState(
                                'calendar-plus',
                                "You haven't created any availability slots yet.",
                                'Create Your First Slot',
                                () => this.app.showModal('createSlotModal')
                            )
                        );
                        loadMoreBtn.style.display = 'none';
                        return;
                    }

                    demoSlots.forEach(slot => {
                        const slotCard = this.createSlotCard(slot);
                        container.appendChild(slotCard);
                    });

                    loadMoreBtn.style.display = demoSlots.length < 5 ? 'none' : 'block';
                }, loadMore ? 800 : 1200);
            }

            createSlotCard(slot) {
                const slotCard = document.createElement('div');
                slotCard.className = 'slot-card';

                const slotDateTime = new Date(`${slot.date}T${slot.startTime}`);
                const now = new Date();
                const hoursDiff = (slotDateTime - now) / (1000 * 60 * 60);

                let statusClass = 'status-upcoming';
                let statusText = 'Available';

                if (slotDateTime < now) {
                    statusClass = 'status-completed';
                    statusText = 'Past';
                }

                slotCard.innerHTML = `
                    <div class="slot-header">
                        <div class="slot-date">${slot.date}</div>
                        <span class="slot-status ${statusClass}">${statusText}</span>
                    </div>
                    <div class="slot-time">${slot.startTime} - ${slot.endTime}</div>
                    <div class="slot-actions">
                        ${hoursDiff > 24 ? `
                            <button class="btn btn-outline btn-sm cancel-slot" data-slotid="${slot.id}">
                                <i class="fas fa-times"></i> Cancel
                            </button>
                        ` : `
                            <span class="text-danger">Cannot cancel within 24 hours</span>
                        `}
                    </div>
                `;

                const cancelBtn = slotCard.querySelector('.cancel-slot');
                if (cancelBtn) {
                    cancelBtn.addEventListener('click', () => {
                        this.handleCancelSlot(slot.id, slotCard);
                    });
                }

                return slotCard;
            }

            handleCancelSlot(slotId, card) {
                this.app.showConfirmation(
                    'Are you sure you want to cancel this slot and all associated bookings?',
                    async () => {
                        const button = card.querySelector('.cancel-slot');
                        const originalContent = button.innerHTML;
                        button.innerHTML = '<div class="loading"></div>';
                        button.disabled = true;

                        setTimeout(() => {
                            card.classList.add('fade-out');
                            this.app.showToast('Slot cancelled successfully!', 'success');
                            setTimeout(() => this.loadTutorSlots(false), 2000);
                        }, 2000);
                    }
                );
            }

            async loadTutorSessions() {
                const container = document.getElementById('tutorSessions');
                container.innerHTML = '';
                container.appendChild(this.createLoadingState());

                setTimeout(() => {
                    container.innerHTML = '';
                    
                    const demoSessions = [
                        {
                            id: 'tutor-session-1',
                            date: '2025-09-25',
                            startTime: '10:00',
                            endTime: '11:00',
                            studentName: 'Alice Johnson',
                            subject: 'Mathematics',
                            status: 'confirmed'
                        }
                    ];

                    if (demoSessions.length === 0) {
                        container.appendChild(
                            this.createEmptyState('clock', "You don't have any upcoming sessions.")
                        );
                        return;
                    }

                    demoSessions.forEach(session => {
                        const sessionCard = this.createTutorSessionCard(session);
                        container.appendChild(sessionCard);
                    });
                }, 1000);
            }

            createTutorSessionCard(session) {
                const sessionCard = document.createElement('div');
                sessionCard.className = 'session-card';

                sessionCard.innerHTML = `
                    <div class="session-header">
                        <div class="slot-date">${session.date}</div>
                        <span class="slot-status status-upcoming">${session.status}</span>
                    </div>
                    <div class="slot-time">${session.startTime} - ${session.endTime}</div>
                    <div class="student-info">
                        <p><strong>Student:</strong> ${session.studentName}</p>
                        <p><strong>Subject:</strong> ${session.subject}</p>
                    </div>
                    <div class="session-actions">
                        <button class="btn btn-primary btn-sm complete-session" data-sessionid="${session.id}">
                            <i class="fas fa-check"></i> Complete
                        </button>
                        <button class="btn btn-outline btn-sm cancel-session" data-sessionid="${session.id}">
                            <i class="fas fa-times"></i> Cancel
                        </button>
                    </div>
                `;

                const completeBtn = sessionCard.querySelector('.complete-session');
                const cancelBtn = sessionCard.querySelector('.cancel-session');

                completeBtn.addEventListener('click', () => {
                    this.handleCompleteSession(session.id, sessionCard);
                });

                cancelBtn.addEventListener('click', () => {
                    this.handleCancelTutorSession(session.id, sessionCard);
                });

                return sessionCard;
            }

            handleCompleteSession(sessionId, card) {
                this.app.showConfirmation('Mark this session as completed?', async () => {
                    const button = card.querySelector('.complete-session');
                    const originalContent = button.innerHTML;
                    button.innerHTML = '<div class="loading"></div>';
                    button.disabled = true;

                    setTimeout(() => {
                        card.classList.add('fade-out');
                        this.app.showToast('Session marked as completed!', 'success');
                    }, 1500);
                });
            }

            handleCancelTutorSession(sessionId, card) {
                this.app.showConfirmation('Cancel this session?', async () => {
                    const button = card.querySelector('.cancel-session');
                    const originalContent = button.innerHTML;
                    button.innerHTML = '<div class="loading"></div>';
                    button.disabled = true;

                    setTimeout(() => {
                        card.classList.add('fade-out');
                        this.app.showToast('Session cancelled!', 'success');
                    }, 1500);
                });
            }
        }

        // Initialize Application
        const schedulerApp = new SchedulerApp();

        // Cleanup on page unload
        window.addEventListener('beforeunload', () => {
            if (schedulerApp.cleanup) {
                schedulerApp.cleanup();
            }
        });
    </script>
</body>
</html>
